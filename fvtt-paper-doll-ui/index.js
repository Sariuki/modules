/*! For license information please see index.js.LICENSE.txt */
(()=>{"use strict";var t={d:(r,o)=>{for(var i in o)t.o(o,i)&&!t.o(r,i)&&Object.defineProperty(r,i,{enumerable:!0,get:o[i]})},o:(t,r)=>Object.prototype.hasOwnProperty.call(t,r)};function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(a=i.key,l=void 0,l=function _toPrimitive(t,r){if("object"!==_typeof(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,r||"default");if("object"!==_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(a,"string"),"symbol"===_typeof(l)?l:String(l)),i)}var a,l}function _get(){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function _get(t,r,o){var i=function _superPropBase(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&null!==(t=_getPrototypeOf(t)););return t}(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:o):a.value}},_get.apply(this,arguments)}function _setPrototypeOf(t,r){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(t,r){return t.__proto__=r,t},_setPrototypeOf(t,r)}function _createSuper(t){var r=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return function _possibleConstructorReturn(t,r){if(r&&("object"===_typeof(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,o)}}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}t.d({},{z1:()=>E,Of:()=>G,ce:()=>I});var r=function(t){!function _inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&_setPrototypeOf(t,r)}(ActorConfig,FormApplication);var r=_createSuper(ActorConfig);function ActorConfig(t){var o;return function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,ActorConfig),(o=r.call(this)).object=t,o}return function _createClass(t,r,o){return r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}(ActorConfig,[{key:"getData",value:function getData(){return this.object}},{key:"_updateObject",value:function _updateObject(t,r){t.preventDefault(),r=foundry.utils.expandObject(r),this.object.update(r)}}],[{key:"defaultOptions",get:function get(){return foundry.utils.mergeObject(_get(_getPrototypeOf(ActorConfig),"defaultOptions",this),{id:"paper-doll-actor-config",title:game.i18n.localize("".concat(I,".app.actor-config.title")),template:"modules/".concat(I,"/templates/actor-config.hbs"),width:400,height:"auto",closeOnSubmit:!0,submitOnClose:!1})}}]),ActorConfig}();function formBuilder_typeof(t){return formBuilder_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},formBuilder_typeof(t)}function _toConsumableArray(t){return function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}(t)||function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||_unsupportedIterableToArray(t)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _createForOfIteratorHelper(t,r){var o="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=_unsupportedIterableToArray(t))||r&&t&&"number"==typeof t.length){o&&(t=o);var i=0,a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,c=!0,u=!1;return{s:function s(){o=o.call(t)},n:function n(){var t=o.next();return c=t.done,t},e:function e(t){u=!0,l=t},f:function f(){try{c||null==o.return||o.return()}finally{if(u)throw l}}}}function _unsupportedIterableToArray(t,r){if(t){if("string"==typeof t)return _arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(t,r):void 0}}function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function formBuilder_get(){return formBuilder_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function _get(t,r,o){var i=function formBuilder_superPropBase(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&null!==(t=formBuilder_getPrototypeOf(t)););return t}(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:o):a.value}},formBuilder_get.apply(this,arguments)}function formBuilder_inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&formBuilder_setPrototypeOf(t,r)}function formBuilder_setPrototypeOf(t,r){return formBuilder_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(t,r){return t.__proto__=r,t},formBuilder_setPrototypeOf(t,r)}function formBuilder_createSuper(t){var r=function formBuilder_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=formBuilder_getPrototypeOf(t);if(r){var a=formBuilder_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return function formBuilder_possibleConstructorReturn(t,r){if(r&&("object"===formBuilder_typeof(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return formBuilder_assertThisInitialized(t)}(this,o)}}function formBuilder_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function formBuilder_getPrototypeOf(t){return formBuilder_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)},formBuilder_getPrototypeOf(t)}function ownKeys(t,r){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),o.push.apply(o,i)}return o}function _objectSpread(t){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(o),!0).forEach((function(r){_defineProperty(t,r,o[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):ownKeys(Object(o)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(o,r))}))}return t}function _defineProperty(t,r,o){return(r=formBuilder_toPropertyKey(r))in t?Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[r]=o,t}function _regeneratorRuntime(){_regeneratorRuntime=function _regeneratorRuntime(){return t};var t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(t,r,o){t[r]=o.value},a="function"==typeof Symbol?Symbol:{},l=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function define(t,r,o){return Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{define({},"")}catch(t){define=function define(t,r,o){return t[r]=o}}function wrap(t,r,o,a){var l=r&&r.prototype instanceof Generator?r:Generator,c=Object.create(l.prototype),u=new Context(a||[]);return i(c,"_invoke",{value:makeInvokeMethod(t,o,u)}),c}function tryCatch(t,r,o){try{return{type:"normal",arg:t.call(r,o)}}catch(t){return{type:"throw",arg:t}}}t.wrap=wrap;var p={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var d={};define(d,l,(function(){return this}));var h=Object.getPrototypeOf,y=h&&h(h(values([])));y&&y!==r&&o.call(y,l)&&(d=y);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(d);function defineIteratorMethods(t){["next","throw","return"].forEach((function(r){define(t,r,(function(t){return this._invoke(r,t)}))}))}function AsyncIterator(t,r){function invoke(i,a,l,c){var u=tryCatch(t[i],t,a);if("throw"!==u.type){var p=u.arg,d=p.value;return d&&"object"==formBuilder_typeof(d)&&o.call(d,"__await")?r.resolve(d.__await).then((function(t){invoke("next",t,l,c)}),(function(t){invoke("throw",t,l,c)})):r.resolve(d).then((function(t){p.value=t,l(p)}),(function(t){return invoke("throw",t,l,c)}))}c(u.arg)}var a;i(this,"_invoke",{value:function value(t,o){function callInvokeWithMethodAndArg(){return new r((function(r,i){invoke(t,o,r,i)}))}return a=a?a.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,o){var i="suspendedStart";return function(a,l){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===a)throw l;return doneResult()}for(o.method=a,o.arg=l;;){var c=o.delegate;if(c){var u=maybeInvokeDelegate(c,o);if(u){if(u===p)continue;return u}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===i)throw i="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);i="executing";var d=tryCatch(t,r,o);if("normal"===d.type){if(i=o.done?"completed":"suspendedYield",d.arg===p)continue;return{value:d.arg,done:o.done}}"throw"===d.type&&(i="completed",o.method="throw",o.arg=d.arg)}}}function maybeInvokeDelegate(t,r){var o=r.method,i=t.iterator[o];if(void 0===i)return r.delegate=null,"throw"===o&&t.iterator.return&&(r.method="return",r.arg=void 0,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==o&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+o+"' method")),p;var a=tryCatch(i,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var l=a.arg;return l?l.done?(r[t.resultName]=l.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,p):l:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function pushTryEntry(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function resetTryEntry(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var r=t[l];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function next(){for(;++i<t.length;)if(o.call(t,i))return next.value=t[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return a.next=a}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,i(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),i(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===GeneratorFunction||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(r,o,i,a,l){void 0===l&&(l=Promise);var c=new AsyncIterator(wrap(r,o,i,a),l);return t.isGeneratorFunction(o)?c:c.next().then((function(t){return t.done?t.value:c.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,l,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var r=Object(t),o=[];for(var i in r)o.push(i);return o.reverse(),function next(){for(;o.length;){var t=o.pop();if(t in r)return next.value=t,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=void 0)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function handle(o,i){return l.type="throw",l.arg=t,r.next=o,i&&(r.method="next",r.arg=void 0),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],l=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function abrupt(t,r){for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i];if(a.tryLoc<=this.prev&&o.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var l=a;break}}l&&("break"===t||"continue"===t)&&l.tryLoc<=r&&r<=l.finallyLoc&&(l=null);var c=l?l.completion:{};return c.type=t,c.arg=r,l?(this.method="next",this.next=l.finallyLoc,p):this.complete(c)},complete:function complete(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),p},finish:function finish(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.finallyLoc===t)return this.complete(o.completion,o.afterLoc),resetTryEntry(o),p}},catch:function _catch(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc===t){var i=o.completion;if("throw"===i.type){var a=i.arg;resetTryEntry(o)}return a}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(t,r,o){return this.delegate={iterator:values(t),resultName:r,nextLoc:o},"next"===this.method&&(this.arg=void 0),p}},t}function asyncGeneratorStep(t,r,o,i,a,l,c){try{var u=t[l](c),p=u.value}catch(t){return void o(t)}u.done?r(p):Promise.resolve(p).then(i,a)}function _asyncToGenerator(t){return function(){var r=this,o=arguments;return new Promise((function(i,a){var l=t.apply(r,o);function _next(t){asyncGeneratorStep(l,i,a,_next,_throw,"next",t)}function _throw(t){asyncGeneratorStep(l,i,a,_next,_throw,"throw",t)}_next(void 0)}))}}function formBuilder_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function formBuilder_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,formBuilder_toPropertyKey(i.key),i)}}function formBuilder_createClass(t,r,o){return r&&formBuilder_defineProperties(t.prototype,r),o&&formBuilder_defineProperties(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function formBuilder_toPropertyKey(t){var r=function formBuilder_toPrimitive(t,r){if("object"!==formBuilder_typeof(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,r||"default");if("object"!==formBuilder_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"===formBuilder_typeof(r)?r:String(r)}function _classPrivateMethodInitSpec(t,r){_checkPrivateRedeclaration(t,r),r.add(t)}function _classPrivateFieldInitSpec(t,r,o){_checkPrivateRedeclaration(t,r),r.set(t,o)}function _checkPrivateRedeclaration(t,r){if(r.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateMethodGet(t,r,o){if(!r.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function _classPrivateFieldSet(t,r,o){return function _classApplyDescriptorSet(t,r,o){if(r.set)r.set.call(t,o);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=o}}(t,_classExtractFieldDescriptor(t,r,"set"),o),o}function _classPrivateFieldGet(t,r){return function _classApplyDescriptorGet(t,r){if(r.get)return r.get.call(t);return r.value}(t,_classExtractFieldDescriptor(t,r,"get"))}function _classExtractFieldDescriptor(t,r,o){if(!r.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return r.get(t)}var o="6uy8g1tXqHlhlp65dhiL-genericFormHelper-"+I,i=new WeakMap,a=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakMap,p=new WeakMap,d=new WeakMap,h=new WeakMap,y=new WeakSet,g=function(){function FormBuilder(){formBuilder_classCallCheck(this,FormBuilder),_classPrivateMethodInitSpec(this,y),_classPrivateFieldInitSpec(this,i,{writable:!0,value:[]}),_classPrivateFieldInitSpec(this,a,{writable:!0,value:[]}),_classPrivateFieldInitSpec(this,l,{writable:!0,value:[]}),_classPrivateFieldInitSpec(this,c,{writable:!0,value:{position:{width:560,height:"auto"},window:{}}}),_classPrivateFieldInitSpec(this,u,{writable:!0,value:null}),_classPrivateFieldInitSpec(this,p,{writable:!0,value:null}),_classPrivateFieldInitSpec(this,d,{writable:!0,value:null}),_classPrivateFieldInitSpec(this,h,{writable:!0,value:null}),this.submitButton()}var t,r;return formBuilder_createClass(FormBuilder,[{key:"app",get:function get(){return _classPrivateFieldGet(this,h)}},{key:"render",value:(r=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(){var t;return _regeneratorRuntime().wrap((function _callee$(r){for(;;)switch(r.prev=r.next){case 0:return(t=this.form()).render(!0),r.abrupt("return",t.promise);case 3:case"end":return r.stop()}}),_callee,this)}))),function render(){return r.apply(this,arguments)})},{key:"form",value:function form(){if(_classPrivateFieldGet(this,h))return _classPrivateFieldGet(this,h);var t=new P({tabs:_classPrivateFieldGet(this,i),fields:_classPrivateFieldGet(this,a),buttons:_classPrivateFieldGet(this,l),options:_classPrivateFieldGet(this,c)});return _classPrivateFieldSet(this,h,t),t}},{key:"getHTML",value:function getHTML(){var t=this.form()._prepareContext();return P.registerPartial(),renderTemplate(o,t)}},{key:"getAsClass",value:function getAsClass(t){var r=_objectSpread(_objectSpread({},t),{},{tabs:_classPrivateFieldGet(this,i),fields:_classPrivateFieldGet(this,a),buttons:_classPrivateFieldGet(this,l),options:_classPrivateFieldGet(this,c)});return function(t){formBuilder_inherits(_class,t);var o=formBuilder_createSuper(_class);function _class(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return formBuilder_classCallCheck(this,_class),o.call(this,_objectSpread(_objectSpread({},r),t))}return formBuilder_createClass(_class)}(P)}},{key:"registerAsMenu",value:function registerAsMenu(){var t,r,o,i,a,l,c,u,p,d=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},h=d.moduleId,y=d.key,g=d.name,v=d.label,m=d.icon,b=d.hint,_=d.scope,w=d.restricted,P=d.defaultValue,O=d.onChange,x=d.requiresReload;null!==(t=h)&&void 0!==t||(h=I),null!==(r=_)&&void 0!==r||(_="world"),null!==(o=w)&&void 0!==o||(w=!0),null!==(i=P)&&void 0!==i||(P={}),null!==(a=y)&&void 0!==a||(y="settings"),null!==(l=m)&&void 0!==l||(m="fas fa-cogs"),null!==(c=v)&&void 0!==c||(v="Configure"),null!==(u=g)&&void 0!==u||(g="Configuration Menu"),null!==(p=b)&&void 0!==p||(b="Configure the module settings");var S={settingsMenu:{requiresReload:x,onChange:O,moduleId:h,key:y}},k=this.getAsClass(S);return game.settings.registerMenu(h,y+"-menu",{name:g,label:v,hint:b,icon:m,scope:_,restricted:w,type:k}),game.settings.register(h,y,{scope:_,config:!1,default:P,type:Object,onChange:O,requiresReload:x}),{getSetting:function getSetting(){return game.settings.get(h,y)},setSetting:function setSetting(t){return game.settings.set(h,y,t)}}}},{key:"insertHTML",value:(t=_asyncToGenerator(_regeneratorRuntime().mark((function _callee2(t,r){var o,i,a,l,c,u=arguments;return _regeneratorRuntime().wrap((function _callee2$(p){for(;;)switch(p.prev=p.next){case 0:return o=u.length>2&&void 0!==u[2]?u[2]:"afterend",p.next=3,this.getHTML();case 3:if(i=p.sent,(a=document.createElement("div")).innerHTML=i,l=a.children[0],c=r?t.querySelector(r):t){p.next=10;break}throw new Error("Element ".concat(r," not found"));case 10:return c.insertAdjacentElement(o,l),p.abrupt("return",l);case 12:case"end":return p.stop()}}),_callee2,this)}))),function insertHTML(r,o){return t.apply(this,arguments)})},{key:"title",value:function title(t){return _classPrivateFieldGet(this,c).window.title=t,this}},{key:"resizable",value:function resizable(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return _classPrivateFieldGet(this,c).window.resizable=t,this}},{key:"info",value:function info(t){return _classPrivateFieldGet(this,c).info=t,this}},{key:"object",value:function object(t){return _classPrivateFieldSet(this,d,t),this}},{key:"size",value:function size(t){var r=t.width,o=t.height;return _classPrivateFieldGet(this,c).position={width:null!=r?r:560,height:null!=o?o:"auto"},this}},{key:"submitButton",value:function submitButton(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.enabled,o=void 0===r||r,i=t.label,a=void 0===i?"Confirm":i,c=t.icon,submitButton={type:"submit",action:"submit",icon:void 0===c?"fa-solid fa-check":c,label:a};return o?_classPrivateFieldGet(this,l).push(submitButton):_classPrivateFieldSet(this,l,_classPrivateFieldGet(this,l).filter((function(t){return"submit"!==t.action}))),this}},{key:"tab",value:function tab(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=r.id,a=r.group,l=r.icon,c=r.label,p=r.active,d=void 0!==p&&p;if(null!==(t=a)&&void 0!==t||(a="sheet"),!o&&_classPrivateFieldGet(this,u))return _classPrivateFieldSet(this,u,null),this;if(!o)throw new Error("You must provide an id for the tab");var tab={id:o,group:a,icon:l,label:c,active:d,fields:[]};return _classPrivateFieldGet(this,i).push(tab),_classPrivateFieldSet(this,u,tab),this}},{key:"fieldset",value:function fieldset(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).legend;if(!t&&_classPrivateFieldGet(this,p))return _classPrivateFieldSet(this,p,null),this;if(!t)throw new Error("You must provide a legend for the fieldset");var fieldset={legend:t,fieldset:!0,fields:[]};return _classPrivateMethodGet(this,y,_addField2).call(this,fieldset),_classPrivateFieldSet(this,p,fieldset),this}},{key:"html",value:function html(t){var r={html:t};return _classPrivateMethodGet(this,y,_addField2).call(this,r),this}},{key:"text",value:function text(t){var r=t.name,o=t.label,i=t.hint,a=t.value,l={field:new foundry.data.fields.StringField,name:r,label:o,hint:i,value:a};return _classPrivateMethodGet(this,y,_addField2).call(this,l),this}},{key:"number",value:function number(t){var r=t.name,o=t.label,i=t.hint,a=t.value,l=t.min,c=t.max,u=t.step,p={field:new foundry.data.fields.NumberField,name:r,label:o,hint:i,value:a,min:l,max:c,step:u};return _classPrivateMethodGet(this,y,_addField2).call(this,p),this}},{key:"checkbox",value:function checkbox(t){var r=t.name,o=t.label,i=t.hint,a=t.value,l={field:new foundry.data.fields.BooleanField,name:r,label:o,hint:i,value:a};return _classPrivateMethodGet(this,y,_addField2).call(this,l),this}},{key:"color",value:function color(t){var r=t.name,o=t.label,i=t.hint,a=t.value,l={field:new foundry.data.fields.ColorField,name:r,label:o,hint:i,value:a};return _classPrivateMethodGet(this,y,_addField2).call(this,l),this}},{key:"file",value:function file(t){var r,o=t.name,i=t.type,a=t.label,l=t.hint,c=t.value;null!==(r=i)&&void 0!==r||(i="imagevideo");var u=v[i],p=new foundry.data.fields.FilePathField({categories:u});p.categories=[i];var d={field:p,name:o,label:a,hint:l,type:i,value:c};return _classPrivateMethodGet(this,y,_addField2).call(this,d),this}},{key:"select",value:function select(t){var r=t.name,o=t.label,i=t.hint,a=t.value,l=t.options,c={field:inferSelectDataType(l)===Number?new foundry.data.fields.NumberField({choices:l}):new foundry.data.fields.StringField({choices:l}),name:r,label:o,hint:i,value:a,options:l};return _classPrivateMethodGet(this,y,_addField2).call(this,c),this}},{key:"multiSelect",value:function multiSelect(t){var r=t.name,o=t.label,i=t.hint,a=t.value,l=t.options,c=inferSelectDataType(l)===Number?new foundry.data.fields.NumberField({choices:l}):new foundry.data.fields.StringField({choices:l}),u={field:new foundry.data.fields.SetField(c),name:r,label:o,hint:i,value:a,options:l};return _classPrivateMethodGet(this,y,_addField2).call(this,u),this}},{key:"editor",value:function editor(t){var r=t.name,o=t.label,i=t.hint,a=t.value,l={field:new foundry.data.fields.HTMLField,name:r,label:o,hint:i,value:a};return _classPrivateMethodGet(this,y,_addField2).call(this,l),this}},{key:"textArea",value:function textArea(t){var r=t.name,o=t.label,i=t.hint,a=t.value,l={field:new foundry.data.fields.JSONField,name:r,label:o,hint:i,value:a,stacked:!0};return _classPrivateMethodGet(this,y,_addField2).call(this,l),this}},{key:"button",value:function button(t){var r,o=t.label,i=t.action,a=t.icon,c=t.callback;null!==(r=i)&&void 0!==r||(i=foundry.utils.randomID());var button={action:i,type:"button",icon:a,label:o,callback:c};return _classPrivateFieldGet(this,l).push(button),this}}]),FormBuilder}();function _addField2(t){if(_classPrivateFieldGet(this,d)&&t.name){var r=foundry.utils.getProperty(_classPrivateFieldGet(this,d),t.name);void 0!==r&&(t.value=r)}return _classPrivateFieldGet(this,p)?_classPrivateFieldGet(this,p).fields.push(t):_classPrivateFieldGet(this,u)?_classPrivateFieldGet(this,u).fields.push(t):_classPrivateFieldGet(this,a).push(t)}var v={imagevideo:["IMAGE","VIDEO"],image:["IMAGE"],video:["VIDEO"],audio:["AUDIO"],font:["FONT"],graphics:["GRAPHICS"]};function inferSelectDataType(t){var r=Object.keys(t);try{if(r.every((function(t){return"number"==typeof JSON.parse(t)})))return Number}catch(t){return String}return String}var m=new WeakMap,b=new WeakMap,_=new WeakMap,w=new WeakSet,P=function(t){formBuilder_inherits(FormHelper,foundry.applications.api.HandlebarsApplicationMixin(foundry.applications.api.ApplicationV2));var r=formBuilder_createSuper(FormHelper);function FormHelper(t){var o;formBuilder_classCallCheck(this,FormHelper);var i={};return t.buttons.forEach((function(t){return i[t.action]=t.callback})),_classPrivateMethodInitSpec(formBuilder_assertThisInitialized(o=r.call(this,_objectSpread({actions:i},t.options))),w),_classPrivateFieldInitSpec(formBuilder_assertThisInitialized(o),m,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(formBuilder_assertThisInitialized(o),b,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(formBuilder_assertThisInitialized(o),_,{writable:!0,value:void 0}),FormHelper.registerPartial(),o.menu=t.settingsMenu,o.resolve,o.reject,o.promise=new Promise((function(t,r){o.resolve=t,o.reject=r})),_classPrivateFieldSet(formBuilder_assertThisInitialized(o),_,t.options.info),o.processFormStructure(t),o}return formBuilder_createClass(FormHelper,[{key:"processFormStructure",value:function processFormStructure(t){var r,o,i,a=this.menu?game.settings.get(this.menu.moduleId,this.menu.key):{},l=!!this.menu;if(null!==(r=t.tabs)&&void 0!==r&&r.length){this.__tabs={},t.tabs.find((function(t){return t.active}))||(t.tabs[0].active=!0);var c,u=_createForOfIteratorHelper(t.tabs);try{for(u.s();!(c=u.n()).done;){var p,d,h=c.value;if(this.__tabs[h.id]={id:h.id,group:h.group,icon:h.icon,label:h.label,active:null!==(p=h.active)&&void 0!==p&&p,fields:null!==(d=h.fields)&&void 0!==d?d:[]},l){var y,g,v=_createForOfIteratorHelper(null!==(y=h.fields)&&void 0!==y?y:[]);try{for(v.s();!(g=v.n()).done;){var _=g.value,w=foundry.utils.getProperty(a,_.name);void 0!==w&&(_.value=w)}}catch(t){v.e(t)}finally{v.f()}}}}catch(t){u.e(t)}finally{u.f()}}if(l){var P,O,x=_createForOfIteratorHelper(null!==(P=t.fields)&&void 0!==P?P:[]);try{for(x.s();!(O=x.n()).done;){var S=O.value,k=foundry.utils.getProperty(a,S.name);void 0!==k&&(S.value=k)}}catch(t){x.e(t)}finally{x.f()}}_classPrivateFieldSet(this,m,null!==(o=t.fields)&&void 0!==o?o:[]),_classPrivateFieldSet(this,b,null!==(i=t.buttons)&&void 0!==i?i:[])}},{key:"_onClose",value:function _onClose(t){formBuilder_get(formBuilder_getPrototypeOf(FormHelper.prototype),"_onClose",this).call(this,t),this.promise.resolved||this.resolve(!1)}},{key:"_prepareContext",value:function _prepareContext(t){return{tabs:_classPrivateMethodGet(this,w,_getTabs2).call(this),fields:_classPrivateFieldGet(this,m),info:_classPrivateFieldGet(this,_),buttons:[].concat(_toConsumableArray(_classPrivateFieldGet(this,b).filter((function(t){return"submit"!==t.type}))),_toConsumableArray(_classPrivateFieldGet(this,b).filter((function(t){return"submit"===t.type}))))}}},{key:"_onRender",value:function _onRender(t,r){formBuilder_get(formBuilder_getPrototypeOf(FormHelper.prototype),"_onRender",this).call(this,t,r),this.__tabs||this.element.querySelector("nav").classList.add("hidden")}},{key:"changeTab",value:function changeTab(){for(var t,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];(t=formBuilder_get(formBuilder_getPrototypeOf(FormHelper.prototype),"changeTab",this)).call.apply(t,[this].concat(o))}},{key:"_onChangeForm",value:function _onChangeForm(t,r){formBuilder_get(formBuilder_getPrototypeOf(FormHelper.prototype),"_onChangeForm",this).call(this,t,r);new FormDataExtended(this.element)}},{key:"getFormData",value:function getFormData(){var t=new FormDataExtended(this.element);return foundry.utils.expandObject(t.object)}}],[{key:"registerPartial",value:function registerPartial(){if(!Handlebars.partials[o]){var t=Handlebars.compile(x);Handlebars.registerPartial(o,t)}}}]),FormHelper}();function _getTabs2(){for(var t,r=null!==(t=this.__tabs)&&void 0!==t?t:{},o=0,i=Object.values(r);o<i.length;o++){var a=i[o];if(a.cssClass=a.active?"active":"",a.active)break}return r}function _onSubmit3(){return(_onSubmit3=_asyncToGenerator(_regeneratorRuntime().mark((function _callee3(t,r,o){var i;return _regeneratorRuntime().wrap((function _callee3$(t){for(;;)switch(t.prev=t.next){case 0:if(i=foundry.utils.expandObject(o.object),this.resolve(i),!this.menu){t.next=6;break}return this.menu.requiresReload&&SettingsConfig.reloadConfirm(),this.menu.onChange&&this.menu.onChange(i),t.abrupt("return",game.settings.set(this.menu.moduleId,this.menu.key,i));case 6:case"end":return t.stop()}}),_callee3,this)})))).apply(this,arguments)}_defineProperty(P,"DEFAULT_OPTIONS",{classes:["form-helper"],tag:"form",window:{contentClasses:["standard-form"]},position:{width:560,height:"auto"},form:{handler:function _classStaticPrivateMethodGet(t,r,o){return function _classCheckPrivateStaticAccess(t,r){if(t!==r)throw new TypeError("Private static access of wrong provenance")}(t,r),o}(P,P,(function _onSubmit(t,r,o){return _onSubmit3.apply(this,arguments)})),closeOnSubmit:!0},actions:{}}),_defineProperty(P,"PARTS",{tabs:{template:"templates/generic/tab-navigation.hbs"},genericForm:{template:o,classes:["standard-form"]},footer:{template:"templates/generic/form-footer.hbs"}});var O="\n    {{#if field.fieldset}}\n    <fieldset>\n        <legend>{{localize field.legend}}</legend>\n        {{#each field.fields as |f|}}\n        {{#if f.html}}{{{f.html}}}{{else}}\n        {{formField f.field stacked=f.stacked type=f.type label=f.label hint=f.hint name=f.name value=f.value min=f.min max=f.max step=f.step localize=true}}\n        {{/if}}\n        {{/each}}\n    </fieldset>\n    {{else}}\n    {{#if field.html}}{{{field.html}}}{{else}}\n    {{formField field.field stacked=field.stacked type=field.type label=field.label hint=field.hint name=field.name value=field.value min=field.min max=field.max step=field.step localize=true}}\n    {{/if}}\n    {{/if}}\n        ",x='<div>\n    {{#if info}}{{{info}}}{{/if}}\n    {{#each tabs as |tab|}}\n\n    <section class="tab standard-form scrollable {{tab.cssClass}}" data-tab="{{tab.id}}" data-group="{{tab.group}}">\n        {{#each tab.fields as |field|}}\n        '.concat(O,"\n        {{/each}}\n    </section>\n\n    {{/each}}\n\n    {{#each fields as |field|}}\n    ").concat(O,"\n    {{/each}}\n</div>");function app_typeof(t){return app_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},app_typeof(t)}function _slicedToArray(t,r){return function _arrayWithHoles(t){if(Array.isArray(t))return t}(t)||function _iterableToArrayLimit(t,r){var o=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=o){var i,a,l,c,u=[],p=!0,d=!1;try{if(l=(o=o.call(t)).next,0===r){if(Object(o)!==o)return;p=!1}else for(;!(p=(i=l.call(o)).done)&&(u.push(i.value),u.length!==r);p=!0);}catch(t){d=!0,a=t}finally{try{if(!p&&null!=o.return&&(c=o.return(),Object(c)!==c))return}finally{if(d)throw a}}return u}}(t,r)||function app_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return app_arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);if("Map"===o||"Set"===o)return Array.from(t);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return app_arrayLikeToArray(t,r)}(t,r)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function app_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function app_regeneratorRuntime(){app_regeneratorRuntime=function _regeneratorRuntime(){return t};var t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(t,r,o){t[r]=o.value},a="function"==typeof Symbol?Symbol:{},l=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function define(t,r,o){return Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{define({},"")}catch(t){define=function define(t,r,o){return t[r]=o}}function wrap(t,r,o,a){var l=r&&r.prototype instanceof Generator?r:Generator,c=Object.create(l.prototype),u=new Context(a||[]);return i(c,"_invoke",{value:makeInvokeMethod(t,o,u)}),c}function tryCatch(t,r,o){try{return{type:"normal",arg:t.call(r,o)}}catch(t){return{type:"throw",arg:t}}}t.wrap=wrap;var p={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var d={};define(d,l,(function(){return this}));var h=Object.getPrototypeOf,y=h&&h(h(values([])));y&&y!==r&&o.call(y,l)&&(d=y);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(d);function defineIteratorMethods(t){["next","throw","return"].forEach((function(r){define(t,r,(function(t){return this._invoke(r,t)}))}))}function AsyncIterator(t,r){function invoke(i,a,l,c){var u=tryCatch(t[i],t,a);if("throw"!==u.type){var p=u.arg,d=p.value;return d&&"object"==app_typeof(d)&&o.call(d,"__await")?r.resolve(d.__await).then((function(t){invoke("next",t,l,c)}),(function(t){invoke("throw",t,l,c)})):r.resolve(d).then((function(t){p.value=t,l(p)}),(function(t){return invoke("throw",t,l,c)}))}c(u.arg)}var a;i(this,"_invoke",{value:function value(t,o){function callInvokeWithMethodAndArg(){return new r((function(r,i){invoke(t,o,r,i)}))}return a=a?a.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,o){var i="suspendedStart";return function(a,l){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===a)throw l;return doneResult()}for(o.method=a,o.arg=l;;){var c=o.delegate;if(c){var u=maybeInvokeDelegate(c,o);if(u){if(u===p)continue;return u}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===i)throw i="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);i="executing";var d=tryCatch(t,r,o);if("normal"===d.type){if(i=o.done?"completed":"suspendedYield",d.arg===p)continue;return{value:d.arg,done:o.done}}"throw"===d.type&&(i="completed",o.method="throw",o.arg=d.arg)}}}function maybeInvokeDelegate(t,r){var o=r.method,i=t.iterator[o];if(void 0===i)return r.delegate=null,"throw"===o&&t.iterator.return&&(r.method="return",r.arg=void 0,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==o&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+o+"' method")),p;var a=tryCatch(i,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var l=a.arg;return l?l.done?(r[t.resultName]=l.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,p):l:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function pushTryEntry(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function resetTryEntry(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var r=t[l];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function next(){for(;++i<t.length;)if(o.call(t,i))return next.value=t[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return a.next=a}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,i(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),i(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===GeneratorFunction||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(r,o,i,a,l){void 0===l&&(l=Promise);var c=new AsyncIterator(wrap(r,o,i,a),l);return t.isGeneratorFunction(o)?c:c.next().then((function(t){return t.done?t.value:c.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,l,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var r=Object(t),o=[];for(var i in r)o.push(i);return o.reverse(),function next(){for(;o.length;){var t=o.pop();if(t in r)return next.value=t,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=void 0)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function handle(o,i){return l.type="throw",l.arg=t,r.next=o,i&&(r.method="next",r.arg=void 0),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],l=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function abrupt(t,r){for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i];if(a.tryLoc<=this.prev&&o.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var l=a;break}}l&&("break"===t||"continue"===t)&&l.tryLoc<=r&&r<=l.finallyLoc&&(l=null);var c=l?l.completion:{};return c.type=t,c.arg=r,l?(this.method="next",this.next=l.finallyLoc,p):this.complete(c)},complete:function complete(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),p},finish:function finish(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.finallyLoc===t)return this.complete(o.completion,o.afterLoc),resetTryEntry(o),p}},catch:function _catch(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc===t){var i=o.completion;if("throw"===i.type){var a=i.arg;resetTryEntry(o)}return a}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(t,r,o){return this.delegate={iterator:values(t),resultName:r,nextLoc:o},"next"===this.method&&(this.arg=void 0),p}},t}function app_asyncGeneratorStep(t,r,o,i,a,l,c){try{var u=t[l](c),p=u.value}catch(t){return void o(t)}u.done?r(p):Promise.resolve(p).then(i,a)}function app_asyncToGenerator(t){return function(){var r=this,o=arguments;return new Promise((function(i,a){var l=t.apply(r,o);function _next(t){app_asyncGeneratorStep(l,i,a,_next,_throw,"next",t)}function _throw(t){app_asyncGeneratorStep(l,i,a,_next,_throw,"throw",t)}_next(void 0)}))}}function app_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(a=i.key,l=void 0,l=function app_toPrimitive(t,r){if("object"!==app_typeof(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,r||"default");if("object"!==app_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(a,"string"),"symbol"===app_typeof(l)?l:String(l)),i)}var a,l}function app_get(){return app_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function _get(t,r,o){var i=function app_superPropBase(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&null!==(t=app_getPrototypeOf(t)););return t}(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:o):a.value}},app_get.apply(this,arguments)}function app_setPrototypeOf(t,r){return app_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(t,r){return t.__proto__=r,t},app_setPrototypeOf(t,r)}function app_createSuper(t){var r=function app_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=app_getPrototypeOf(t);if(r){var a=app_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return function app_possibleConstructorReturn(t,r){if(r&&("object"===app_typeof(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return app_assertThisInitialized(t)}(this,o)}}function app_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function app_getPrototypeOf(t){return app_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)},app_getPrototypeOf(t)}function app_classPrivateFieldInitSpec(t,r,o){!function app_checkPrivateRedeclaration(t,r){if(r.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,r),r.set(t,o)}function app_classPrivateFieldSet(t,r,o){return function app_classApplyDescriptorSet(t,r,o){if(r.set)r.set.call(t,o);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=o}}(t,app_classExtractFieldDescriptor(t,r,"set"),o),o}function app_classExtractFieldDescriptor(t,r,o){if(!r.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return r.get(t)}var S=450,k=new WeakMap,T=function(t){!function app_inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&app_setPrototypeOf(t,r)}(PaperDoll,Application);var o,i,a,l,c,u=app_createSuper(PaperDoll);function PaperDoll(t){var r;return function app_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,PaperDoll),app_classPrivateFieldInitSpec(app_assertThisInitialized(r=u.call(this)),k,{writable:!0,value:void 0}),app_classPrivateFieldSet(app_assertThisInitialized(r),k,t),r.wrapSheet(),document.documentElement.style.setProperty("--paper-doll-main-color",getSetting("globalConfig").MAIN_COLOR),document.documentElement.style.setProperty("--paper-doll-slot-hue-rotate",getSetting("globalConfig").HUE_ROTATE+"deg"),r.updateActorHook=Hooks.on("updateActor",(function(t,o){t.id===r.actor.id&&r.render(!0)})),r}return function app_createClass(t,r,o){return r&&app_defineProperties(t.prototype,r),o&&app_defineProperties(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}(PaperDoll,[{key:"actor",get:function get(){return function app_classPrivateFieldGet(t,r){return function app_classApplyDescriptorGet(t,r){return r.get?r.get.call(t):r.value}(t,app_classExtractFieldDescriptor(t,r,"get"))}(this,k)}},{key:"title",get:function get(){return this.actor.name}},{key:"id",get:function get(){return this.constructor.APP_ID+"-"+this.actor.uuid}},{key:"getSlots",value:function getSlots(){var t;return foundry.utils.deepClone(null!==(t=this.actor.getFlag(I,"slots"))&&void 0!==t?t:{})}},{key:"wrapSheet",value:function wrapSheet(){var t=this,r=this.actor.sheet;r&&!this.resizable&&(this._originalSheetSetPosition=r.setPosition,r.setPosition=function(){for(var o,i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];var c=(o=t._originalSheetSetPosition).call.apply(o,[r].concat(a));return t.attachToSheet(),c},this._originalClose=r.close,r.close=app_asyncToGenerator(app_regeneratorRuntime().mark((function _callee(){var o,i,a,l,c,u=arguments;return app_regeneratorRuntime().wrap((function _callee$(p){for(;;)switch(p.prev=p.next){case 0:for(t.unwrapSheet(),i=u.length,a=new Array(i),l=0;l<i;l++)a[l]=u[l];return t.close.apply(t,a),p.next=5,(o=t._originalClose).call.apply(o,[r].concat(a));case 5:return c=p.sent,p.abrupt("return",c);case 7:case"end":return p.stop()}}),_callee)}))),this._originalMinimize=r.minimize,r.minimize=app_asyncToGenerator(app_regeneratorRuntime().mark((function _callee2(){var o,i,a,l,c,u=arguments;return app_regeneratorRuntime().wrap((function _callee2$(p){for(;;)switch(p.prev=p.next){case 0:for(t.setVisibility(!1),i=u.length,a=new Array(i),l=0;l<i;l++)a[l]=u[l];return p.next=4,(o=t._originalMinimize).call.apply(o,[r].concat(a));case 4:return c=p.sent,p.abrupt("return",c);case 6:case"end":return p.stop()}}),_callee2)}))),this._originalMaximize=r.maximize,r.maximize=app_asyncToGenerator(app_regeneratorRuntime().mark((function _callee3(){var o,i,a,l,c,u=arguments;return app_regeneratorRuntime().wrap((function _callee3$(p){for(;;)switch(p.prev=p.next){case 0:for(t.setVisibility(!0),i=u.length,a=new Array(i),l=0;l<i;l++)a[l]=u[l];return p.next=4,(o=t._originalMaximize).call.apply(o,[r].concat(a));case 4:return c=p.sent,p.abrupt("return",c);case 6:case"end":return p.stop()}}),_callee3)}))))}},{key:"unwrapSheet",value:function unwrapSheet(){var t=this.actor.sheet;Hooks.off("updateActor",this.updateActorHook),t&&this._originalSheetSetPosition&&(t.setPosition=this._originalSheetSetPosition,t.minimize=this._originalMinimize,t.maximize=this._originalMaximize,t.close=this._originalClose)}},{key:"setVisibility",value:function setVisibility(t){this.element[0]&&(this.element[0].closest(".app").style.display=t?"":"none")}},{key:"equip",value:(c=app_asyncToGenerator(app_regeneratorRuntime().mark((function _callee4(t,r,o){var i,a,l;return app_regeneratorRuntime().wrap((function _callee4$(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,fromUuid(t);case 2:if(i=c.sent){c.next=5;break}return c.abrupt("return");case 5:if(Hooks.callAll("paper-doll-equip",this.actor,i,r,o),a={},l=getSetting("globalConfig").EQUIPPED_PATH){c.next=10;break}return c.abrupt("return");case 10:return foundry.utils.setProperty(a,"system.".concat(l),r),c.next=13,i.update(a);case 13:case"end":return c.stop()}}),_callee4,this)}))),function equip(t,r,o){return c.apply(this,arguments)})},{key:"mapSlots",value:function mapSlots(t){var r=this;return Object.entries(this.config.SLOTS[t]).map((function(t){for(var o=_slicedToArray(t,2),i=o[0],a=o[1],l=[],c=0;c<a.length;c++){var u,p,d=null===(u=r.slots[i])||void 0===u?void 0:u[c],h=d?fromUuidSync(d):null,y=h?null===(p=game.modules.get("rarity-colors"))||void 0===p||null===(p=p.api)||void 0===p?void 0:p.getColorFromItem(h):"";l.push({slotIndex:c,slotId:i,image:a[c].img,item:h,itemColor:y,empty:h?"":"paper-doll-empty"})}return l}))}},{key:"_onResize",value:function _onResize(t){app_get(app_getPrototypeOf(PaperDoll.prototype),"_onResize",this).call(this,t)}},{key:"setPosition",value:function setPosition(){for(var t,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];(t=app_get(app_getPrototypeOf(PaperDoll.prototype),"setPosition",this)).call.apply(t,[this].concat(o))}},{key:"getData",value:(l=app_asyncToGenerator(app_regeneratorRuntime().mark((function _callee5(){var t;return app_regeneratorRuntime().wrap((function _callee5$(r){for(;;)switch(r.prev=r.next){case 0:return this.slots=this.getSlots(),this.config=getSetting("globalConfig"),t={left:this.mapSlots("LEFT"),right:this.mapSlots("RIGHT"),bottomLeftWrist:this.mapSlots("BOTTOM_LEFT_WRIST"),bottomLeftMain:this.mapSlots("BOTTOM_LEFT_MAIN"),bottomRightWrist:this.mapSlots("BOTTOM_RIGHT_WRIST"),bottomRightMain:this.mapSlots("BOTTOM_RIGHT_MAIN"),actor:this.actor,portraitImage:this.actor.getFlag(I,"img")||this.actor.img},r.abrupt("return",t);case 4:case"end":return r.stop()}}),_callee5,this)}))),function getData(){return l.apply(this,arguments)})},{key:"activateListeners",value:function activateListeners(t){var o,i=this;app_get(app_getPrototypeOf(PaperDoll.prototype),"activateListeners",this).call(this,t),t=null!==(o=t[0])&&void 0!==o?o:t,this.attachToSheet();var a=this.actor.getFlag(I,"objectFit")||"cover";t.querySelector(".paper-doll-portrait").style.objectFit=a,t.querySelectorAll(".paper-doll-slot").forEach((function(t){t.addEventListener("dragstart",i._onDragStart.bind(i)),t.addEventListener("drop",i._onDrop.bind(i)),t.addEventListener("contextmenu",i._onContextMenu.bind(i)),t.addEventListener("click",i._onClick.bind(i))})),t.querySelectorAll(".paper-doll-control").forEach((function(t){t.addEventListener("click",function(){var t=app_asyncToGenerator(app_regeneratorRuntime().mark((function _callee6(t){var o;return app_regeneratorRuntime().wrap((function _callee6$(a){for(;;)switch(a.prev=a.next){case 0:o=t.currentTarget.dataset.action,a.t0=o,a.next="close"===a.t0?4:"configure"===a.t0?6:8;break;case 4:return i.close(),a.abrupt("break",8);case 6:return new r(i.actor).render(!0),a.abrupt("break",8);case 8:case"end":return a.stop()}}),_callee6)})));return function(r){return t.apply(this,arguments)}}())})),this.setPendantMargin()}},{key:"_onClick",value:function _onClick(t){var r;t.stopPropagation();var o=t.currentTarget.dataset.index,i=t.currentTarget.dataset.id,a=null===(r=this.slots[i])||void 0===r?void 0:r[o],l=a?fromUuidSync(a):null;if(l)return l.sheet.render(!0);var c=Object.values(this.config.SLOTS).find((function(t){return t[i]}))[i][o].filter,u=Object.values(this.config.SLOTS).find((function(t){return t[i]}))[i][o].simpleFilter;if(c||null!=u&&u.length){var p=this.filterItems(this.actor.items,i,o);p.length&&this.setCenterContainerItems(p,i,o)}}},{key:"filterItems",value:function filterItems(t,r,o){var i=Object.values(this.config.SLOTS).find((function(t){return t[r]}))[r][o].filter,a=Object.values(this.config.SLOTS).find((function(t){return t[r]}))[r][o].simpleFilter;if(a&&(t=t.filter((function(t){return a.includes(t.type)}))),i){var l=new Function("item",i);t=t.filter((function(t){return l(t)}))}return t}},{key:"setCenterContainerItems",value:function setCenterContainerItems(t,r,o){var i=this,a=this.element[0].querySelector(".paper-doll-center");a.innerHTML="";var l=document.createElement("div");l.classList.add("inner"),a.appendChild(l),t.forEach((function(t){var c=document.createElement("div");c.classList.add("paper-doll-slot"),c.style.backgroundImage="url('".concat(t.img,"')"),c.dataset.tooltip=t.name,l.appendChild(c),c.addEventListener("click",function(){var a=app_asyncToGenerator(app_regeneratorRuntime().mark((function _callee7(a){var l,c,u;return app_regeneratorRuntime().wrap((function _callee7$(p){for(;;)switch(p.prev=p.next){case 0:return a.stopPropagation(),c=t.uuid,u=i.getSlots(),null!==(l=u[r])&&void 0!==l||(u[r]={}),u[r][o]=c,p.next=7,i.actor.setFlag(I,"slots",u);case 7:return p.next=9,i.equip(c,!0,{slotIndex:o,slotId:r});case 9:case"end":return p.stop()}}),_callee7)})));return function(t){return a.apply(this,arguments)}}()),c.addEventListener("contextmenu",(function(t){t.stopPropagation(),a.innerHTML=""}))}))}},{key:"_onContextMenu",value:(a=app_asyncToGenerator(app_regeneratorRuntime().mark((function _callee8(t){var r,o,i,a,l;return app_regeneratorRuntime().wrap((function _callee8$(c){for(;;)switch(c.prev=c.next){case 0:return t.preventDefault(),t.stopPropagation(),o=t.currentTarget.dataset.index,i=t.currentTarget.dataset.id,a=this.getSlots(),null!==(r=a[i])&&void 0!==r||(a[i]={}),l=a[i][o],a[i][o]=null,c.next=10,this.equip(l,!1,{slotIndex:o,slotId:i});case 10:return c.next=12,this.actor.setFlag(I,"slots",a);case 12:case"end":return c.stop()}}),_callee8,this)}))),function _onContextMenu(t){return a.apply(this,arguments)})},{key:"_onDragStart",value:function _onDragStart(t){var r;t.stopPropagation();var o=t.currentTarget.dataset.index,i=t.currentTarget.dataset.id;t.dataTransfer.setData("text/plain",JSON.stringify({slotIndex:o,slotId:i,type:"Item",uuid:null===(r=this.slots[i])||void 0===r?void 0:r[o]}))}},{key:"_onDrop",value:(i=app_asyncToGenerator(app_regeneratorRuntime().mark((function _callee9(t){var r,o,i,a,l,c,u,p,d,h,y;return app_regeneratorRuntime().wrap((function _callee9$(g){for(;;)switch(g.prev=g.next){case 0:t.stopPropagation(),g.prev=1,i=JSON.parse(t.dataTransfer.getData("text/plain")),g.next=8;break;case 5:return g.prev=5,g.t0=g.catch(1),g.abrupt("return");case 8:return a=t.currentTarget.dataset.index,l=t.currentTarget.dataset.id,c=null===(r=this.slots[l])||void 0===r?void 0:r[a],u=i.slotId,p=i.slotIndex,g.next=15,fromUuid(i.uuid);case 15:if(d=g.sent,this.filterItems([d],l,a).length){g.next=19;break}return g.abrupt("return",ui.notifications.warn("".concat(I,".app.paper-doll.disallowed"),{localize:!0}));case 19:if((null==d?void 0:d.parent)===this.actor||getSetting("allowNonOwned")){g.next=21;break}return g.abrupt("return");case 21:if(h=void 0!==u&&void 0!==p,y=this.getSlots(),null!==(o=y[l])&&void 0!==o||(y[l]={}),!h){g.next=28;break}y[u][p]=null!=c?c:null,g.next=31;break;case 28:if(!c){g.next=31;break}return g.next=31,this.equip(c,!1,{slotIndex:a,slotId:l});case 31:return y[l][a]=d.uuid,g.next=34,this.actor.setFlag(I,"slots",y);case 34:if(h){g.next=39;break}return g.next=37,this.equip(d.uuid,!0,{slotIndex:a,slotId:l});case 37:g.next=40;break;case 39:Hooks.callAll("paper-doll-swap",this.actor,{slotIndex:a,slotId:l,item:d.uuid},{slotIndex:p,slotId:u,item:c});case 40:case"end":return g.stop()}}),_callee9,this,[[1,5]])}))),function _onDrop(t){return i.apply(this,arguments)})},{key:"_getHeaderButtons",value:function _getHeaderButtons(){var t=this,o=app_get(app_getPrototypeOf(PaperDoll.prototype),"_getHeaderButtons",this).call(this);return o.unshift({class:"paper-doll-actor-config",icon:"fas fa-cog",onclick:function onclick(){new r(t.actor).render(!0)},label:game.i18n.localize("".concat(I,".app.").concat(this.constructor.APP_ID,".config"))}),o}},{key:"attachToSheet",value:function attachToSheet(){if(this.element[0]){var t=this.actor.sheet,r=t.rendered,o=this.element[0].querySelector(".window-header");if(r){var i=t.position,a=i.top,l=i.left,c=i.width,u=i.height,p=getSetting("paperDollPosition");if("center"==p||"left"==p&&l<S||"right"==p&&l>window.innerWidth-S)return o.classList.add("paper-doll-header-visible");o.classList.remove("paper-doll-header-visible"),this.setPosition({top:a,left:"left"==p?l-S:l+c,height:u,width:S})}}}},{key:"syncMinimized",value:function syncMinimized(){var t=this.actor.sheet.minimized;t!==this.minimized&&(t?this.minimize():this.maximize())}},{key:"setPendantMargin",value:function setPendantMargin(){var t=this.element[0].querySelectorAll(".paper-doll-slot[data-id='PENDANT']");if(t.length){var r=t[0],o=t[t.length-1];r.style.marginTop="calc(var(--paper-doll-flex-gap) * 4)",o.style.marginBottom="calc(var(--paper-doll-flex-gap) * 4)"}}},{key:"close",value:(o=app_asyncToGenerator(app_regeneratorRuntime().mark((function _callee10(){var t,r,o,i,a=arguments;return app_regeneratorRuntime().wrap((function _callee10$(l){for(;;)switch(l.prev=l.next){case 0:for(this.unwrapSheet(),r=a.length,o=new Array(r),i=0;i<r;i++)o[i]=a[i];(t=app_get(app_getPrototypeOf(PaperDoll.prototype),"close",this)).call.apply(t,[this].concat(o));case 3:case"end":return l.stop()}}),_callee10,this)}))),function close(){return o.apply(this,arguments)})}],[{key:"APP_ID",get:function get(){return"paper-doll"}},{key:"defaultOptions",get:function get(){return foundry.utils.mergeObject(app_get(app_getPrototypeOf(PaperDoll),"defaultOptions",this),{id:this.APP_ID,template:"modules/".concat(I,"/templates/").concat(this.APP_ID,".hbs"),popOut:!0,resizable:"center"===getSetting("paperDollPosition"),minimizable:!0,width:S,height:700,classes:["paper-doll"],title:game.i18n.localize("".concat(I,".app.").concat(this.APP_ID,".title"))})}},{key:"toggle",value:function toggle(){var t=Object.values(ui.windows).find((function(t){return t instanceof PaperDoll}));if(t)t.close();else{var r=ui.activeWindow.object instanceof Actor?ui.activeWindow.object:game.user.character;r&&new PaperDoll(r).render(!0)}}}]),PaperDoll}();function globalConfig_typeof(t){return globalConfig_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},globalConfig_typeof(t)}function globalConfig_regeneratorRuntime(){globalConfig_regeneratorRuntime=function _regeneratorRuntime(){return t};var t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(t,r,o){t[r]=o.value},a="function"==typeof Symbol?Symbol:{},l=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function define(t,r,o){return Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{define({},"")}catch(t){define=function define(t,r,o){return t[r]=o}}function wrap(t,r,o,a){var l=r&&r.prototype instanceof Generator?r:Generator,c=Object.create(l.prototype),u=new Context(a||[]);return i(c,"_invoke",{value:makeInvokeMethod(t,o,u)}),c}function tryCatch(t,r,o){try{return{type:"normal",arg:t.call(r,o)}}catch(t){return{type:"throw",arg:t}}}t.wrap=wrap;var p={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var d={};define(d,l,(function(){return this}));var h=Object.getPrototypeOf,y=h&&h(h(values([])));y&&y!==r&&o.call(y,l)&&(d=y);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(d);function defineIteratorMethods(t){["next","throw","return"].forEach((function(r){define(t,r,(function(t){return this._invoke(r,t)}))}))}function AsyncIterator(t,r){function invoke(i,a,l,c){var u=tryCatch(t[i],t,a);if("throw"!==u.type){var p=u.arg,d=p.value;return d&&"object"==globalConfig_typeof(d)&&o.call(d,"__await")?r.resolve(d.__await).then((function(t){invoke("next",t,l,c)}),(function(t){invoke("throw",t,l,c)})):r.resolve(d).then((function(t){p.value=t,l(p)}),(function(t){return invoke("throw",t,l,c)}))}c(u.arg)}var a;i(this,"_invoke",{value:function value(t,o){function callInvokeWithMethodAndArg(){return new r((function(r,i){invoke(t,o,r,i)}))}return a=a?a.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,o){var i="suspendedStart";return function(a,l){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===a)throw l;return doneResult()}for(o.method=a,o.arg=l;;){var c=o.delegate;if(c){var u=maybeInvokeDelegate(c,o);if(u){if(u===p)continue;return u}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===i)throw i="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);i="executing";var d=tryCatch(t,r,o);if("normal"===d.type){if(i=o.done?"completed":"suspendedYield",d.arg===p)continue;return{value:d.arg,done:o.done}}"throw"===d.type&&(i="completed",o.method="throw",o.arg=d.arg)}}}function maybeInvokeDelegate(t,r){var o=r.method,i=t.iterator[o];if(void 0===i)return r.delegate=null,"throw"===o&&t.iterator.return&&(r.method="return",r.arg=void 0,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==o&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+o+"' method")),p;var a=tryCatch(i,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var l=a.arg;return l?l.done?(r[t.resultName]=l.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,p):l:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function pushTryEntry(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function resetTryEntry(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var r=t[l];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function next(){for(;++i<t.length;)if(o.call(t,i))return next.value=t[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return a.next=a}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,i(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),i(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===GeneratorFunction||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(r,o,i,a,l){void 0===l&&(l=Promise);var c=new AsyncIterator(wrap(r,o,i,a),l);return t.isGeneratorFunction(o)?c:c.next().then((function(t){return t.done?t.value:c.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,l,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var r=Object(t),o=[];for(var i in r)o.push(i);return o.reverse(),function next(){for(;o.length;){var t=o.pop();if(t in r)return next.value=t,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=void 0)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function handle(o,i){return l.type="throw",l.arg=t,r.next=o,i&&(r.method="next",r.arg=void 0),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],l=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function abrupt(t,r){for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i];if(a.tryLoc<=this.prev&&o.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var l=a;break}}l&&("break"===t||"continue"===t)&&l.tryLoc<=r&&r<=l.finallyLoc&&(l=null);var c=l?l.completion:{};return c.type=t,c.arg=r,l?(this.method="next",this.next=l.finallyLoc,p):this.complete(c)},complete:function complete(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),p},finish:function finish(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.finallyLoc===t)return this.complete(o.completion,o.afterLoc),resetTryEntry(o),p}},catch:function _catch(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc===t){var i=o.completion;if("throw"===i.type){var a=i.arg;resetTryEntry(o)}return a}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(t,r,o){return this.delegate={iterator:values(t),resultName:r,nextLoc:o},"next"===this.method&&(this.arg=void 0),p}},t}function globalConfig_ownKeys(t,r){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),o.push.apply(o,i)}return o}function globalConfig_objectSpread(t){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?globalConfig_ownKeys(Object(o),!0).forEach((function(r){globalConfig_defineProperty(t,r,o[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):globalConfig_ownKeys(Object(o)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(o,r))}))}return t}function globalConfig_defineProperty(t,r,o){return(r=globalConfig_toPropertyKey(r))in t?Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[r]=o,t}function globalConfig_asyncGeneratorStep(t,r,o,i,a,l,c){try{var u=t[l](c),p=u.value}catch(t){return void o(t)}u.done?r(p):Promise.resolve(p).then(i,a)}function globalConfig_asyncToGenerator(t){return function(){var r=this,o=arguments;return new Promise((function(i,a){var l=t.apply(r,o);function _next(t){globalConfig_asyncGeneratorStep(l,i,a,_next,_throw,"next",t)}function _throw(t){globalConfig_asyncGeneratorStep(l,i,a,_next,_throw,"throw",t)}_next(void 0)}))}}function globalConfig_slicedToArray(t,r){return function globalConfig_arrayWithHoles(t){if(Array.isArray(t))return t}(t)||function globalConfig_iterableToArrayLimit(t,r){var o=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=o){var i,a,l,c,u=[],p=!0,d=!1;try{if(l=(o=o.call(t)).next,0===r){if(Object(o)!==o)return;p=!1}else for(;!(p=(i=l.call(o)).done)&&(u.push(i.value),u.length!==r);p=!0);}catch(t){d=!0,a=t}finally{try{if(!p&&null!=o.return&&(c=o.return(),Object(c)!==c))return}finally{if(d)throw a}}return u}}(t,r)||function globalConfig_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return globalConfig_arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);if("Map"===o||"Set"===o)return Array.from(t);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return globalConfig_arrayLikeToArray(t,r)}(t,r)||function globalConfig_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function globalConfig_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function globalConfig_defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,globalConfig_toPropertyKey(i.key),i)}}function globalConfig_toPropertyKey(t){var r=function globalConfig_toPrimitive(t,r){if("object"!==globalConfig_typeof(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,r||"default");if("object"!==globalConfig_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"===globalConfig_typeof(r)?r:String(r)}function globalConfig_get(){return globalConfig_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function _get(t,r,o){var i=function globalConfig_superPropBase(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&null!==(t=globalConfig_getPrototypeOf(t)););return t}(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:o):a.value}},globalConfig_get.apply(this,arguments)}function globalConfig_setPrototypeOf(t,r){return globalConfig_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(t,r){return t.__proto__=r,t},globalConfig_setPrototypeOf(t,r)}function globalConfig_createSuper(t){var r=function globalConfig_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=globalConfig_getPrototypeOf(t);if(r){var a=globalConfig_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return function globalConfig_possibleConstructorReturn(t,r){if(r&&("object"===globalConfig_typeof(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return function globalConfig_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,o)}}function globalConfig_getPrototypeOf(t){return globalConfig_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)},globalConfig_getPrototypeOf(t)}var C=function(t){!function globalConfig_inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&globalConfig_setPrototypeOf(t,r)}(GlobalConfig,FormApplication);var r,o,i,a,l,c,u=globalConfig_createSuper(GlobalConfig);function GlobalConfig(){return function globalConfig_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,GlobalConfig),u.apply(this,arguments)}return function globalConfig_createClass(t,r,o){return r&&globalConfig_defineProperties(t.prototype,r),o&&globalConfig_defineProperties(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}(GlobalConfig,[{key:"mapSlots",value:function mapSlots(t){return Object.entries(this.config.SLOTS[t]).map((function(t){for(var r=globalConfig_slicedToArray(t,2),o=r[0],i=r[1],a=[],l=0;l<i.length;l++)a.push({slotIndex:l,slotId:o,image:i[l].img,empty:"paper-doll-empty"});return a.push({slotIndex:"add",slotId:o,image:"",empty:"paper-doll-empty"}),a}))}},{key:"getData",value:(c=globalConfig_asyncToGenerator(globalConfig_regeneratorRuntime().mark((function _callee(){var t;return globalConfig_regeneratorRuntime().wrap((function _callee$(r){for(;;)switch(r.prev=r.next){case 0:return this.config=getSetting("globalConfig"),t=globalConfig_objectSpread({left:this.mapSlots("LEFT"),right:this.mapSlots("RIGHT"),bottomLeftWrist:this.mapSlots("BOTTOM_LEFT_WRIST"),bottomLeftMain:this.mapSlots("BOTTOM_LEFT_MAIN"),bottomRightWrist:this.mapSlots("BOTTOM_RIGHT_WRIST"),bottomRightMain:this.mapSlots("BOTTOM_RIGHT_MAIN"),isConfig:!0},this.config),r.abrupt("return",t);case 3:case"end":return r.stop()}}),_callee,this)}))),function getData(){return c.apply(this,arguments)})},{key:"activateListeners",value:(l=globalConfig_asyncToGenerator(globalConfig_regeneratorRuntime().mark((function _callee3(t){var r=this;return globalConfig_regeneratorRuntime().wrap((function _callee3$(o){for(;;)switch(o.prev=o.next){case 0:globalConfig_get(globalConfig_getPrototypeOf(GlobalConfig.prototype),"activateListeners",this).call(this,t),t=t[0],document.querySelector("#paper-doll-global-config .window-header").classList.add("paper-doll-header-visible"),t.querySelectorAll(".paper-doll-slot[data-index='add']").forEach((function(t){t.innerHTML='<i class="fas fa-plus"></i> Add',t.style.cursor="pointer"})),this.setPendantMargin(),t.querySelectorAll(".paper-doll-slot").forEach((function(t){"add"==t.dataset.index?t.addEventListener("click",(function(t){var o=t.currentTarget.dataset.id;r.addSlot(o)})):(t.addEventListener("click",function(){var t=globalConfig_asyncToGenerator(globalConfig_regeneratorRuntime().mark((function _callee2(t){var o,i,a,l,c,u,p;return globalConfig_regeneratorRuntime().wrap((function _callee2$(d){for(;;)switch(d.prev=d.next){case 0:return o=t.currentTarget.dataset.id,i=parseInt(t.currentTarget.dataset.index),a=Object.values(r.config.SLOTS).find((function(t){return t[o]})),l=a[o][i].img,c=a[o][i].filter,u=a[o][i].simpleFilter,d.next=8,(new g).file({name:"img",label:"".concat(I,".app.paper-doll-global-config.img"),value:l,type:"image"}).multiSelect({name:"simpleFilter",label:"".concat(I,".app.paper-doll-global-config.simpleFilter.label"),hint:"".concat(I,".app.paper-doll-global-config.simpleFilter.hint"),value:u,options:CONFIG.Item.typeLabels}).text({name:"filter",label:"".concat(I,".app.paper-doll-global-config.filter.label"),hint:"".concat(I,".app.paper-doll-global-config.filter.hint"),value:c}).render(!0);case 8:if(p=d.sent){d.next=11;break}return d.abrupt("return");case 11:return a[o][i].img=p.img,a[o][i].filter=p.filter,d.next=15,setSetting("globalConfig",r.config);case 15:return d.abrupt("return",r.render());case 16:case"end":return d.stop()}}),_callee2)})));return function(r){return t.apply(this,arguments)}}()),t.addEventListener("contextmenu",(function(t){var o=t.currentTarget.dataset.id,i=t.currentTarget.dataset.index;r.removeSlot(o,i)})))})),t.querySelectorAll("input").forEach((function(t){t.addEventListener("change",(function(t){r.saveOtherSettings()}))}));case 8:case"end":return o.stop()}}),_callee3,this)}))),function activateListeners(t){return l.apply(this,arguments)})},{key:"saveOtherSettings",value:(a=globalConfig_asyncToGenerator(globalConfig_regeneratorRuntime().mark((function _callee4(){var t,r,o,i,a,l;return globalConfig_regeneratorRuntime().wrap((function _callee4$(c){for(;;)switch(c.prev=c.next){case 0:for(t=Array.from(this.element[0].querySelectorAll("input")),r=0,o=t;r<o.length;r++)i=o[r],a=i.name,l=i.value,this.config[a]=l;return c.next=4,setSetting("globalConfig",this.config);case 4:case"end":return c.stop()}}),_callee4,this)}))),function saveOtherSettings(){return a.apply(this,arguments)})},{key:"setPendantMargin",value:function setPendantMargin(){var t=this.element[0].querySelectorAll(".paper-doll-slot[data-id='PENDANT']");if(t.length){var r=t[0],o=t[t.length-1];r.style.marginTop="calc(var(--paper-doll-flex-gap) * 4)",o.style.marginBottom="calc(var(--paper-doll-flex-gap) * 4)"}}},{key:"addSlot",value:(i=globalConfig_asyncToGenerator(globalConfig_regeneratorRuntime().mark((function _callee5(t){var r,o,i,a,l,c;return globalConfig_regeneratorRuntime().wrap((function _callee5$(u){for(;;)switch(u.prev=u.next){case 0:return a=Object.values(this.config.SLOTS).find((function(r){return r[t]})),l=null!==(r=null!==(o=null===(i=a[t][0])||void 0===i?void 0:i.img)&&void 0!==o?o:Object.values(G.SLOTS).find((function(r){return r[t]}))[t][0].img)&&void 0!==r?r:"",c={img:l},a[t].push(c),u.next=6,setSetting("globalConfig",this.config);case 6:return u.abrupt("return",this.render());case 7:case"end":return u.stop()}}),_callee5,this)}))),function addSlot(t){return i.apply(this,arguments)})},{key:"removeSlot",value:(o=globalConfig_asyncToGenerator(globalConfig_regeneratorRuntime().mark((function _callee6(t,r){return globalConfig_regeneratorRuntime().wrap((function _callee6$(o){for(;;)switch(o.prev=o.next){case 0:return Object.values(this.config.SLOTS).find((function(r){return r[t]}))[t].splice(r,1),o.next=4,setSetting("globalConfig",this.config);case 4:return o.abrupt("return",this.render());case 5:case"end":return o.stop()}}),_callee6,this)}))),function removeSlot(t,r){return o.apply(this,arguments)})},{key:"close",value:(r=globalConfig_asyncToGenerator(globalConfig_regeneratorRuntime().mark((function _callee7(){return globalConfig_regeneratorRuntime().wrap((function _callee7$(t){for(;;)switch(t.prev=t.next){case 0:return this.saveOtherSettings(),t.abrupt("return",globalConfig_get(globalConfig_getPrototypeOf(GlobalConfig.prototype),"close",this).call(this));case 2:case"end":return t.stop()}}),_callee7,this)}))),function close(){return r.apply(this,arguments)})}],[{key:"APP_ID",get:function get(){return"paper-doll-global-config"}},{key:"defaultOptions",get:function get(){return foundry.utils.mergeObject(globalConfig_get(globalConfig_getPrototypeOf(GlobalConfig),"defaultOptions",this),{id:this.APP_ID,template:"modules/".concat(I,"/templates/paper-doll.hbs"),popOut:!0,resizable:!0,minimizable:!0,width:S,height:800,title:game.i18n.localize("".concat(I,".app.").concat(this.APP_ID,".title"))})}}]),GlobalConfig}();function settings_typeof(t){return settings_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},settings_typeof(t)}function settings_regeneratorRuntime(){settings_regeneratorRuntime=function _regeneratorRuntime(){return t};var t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(t,r,o){t[r]=o.value},a="function"==typeof Symbol?Symbol:{},l=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function define(t,r,o){return Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{define({},"")}catch(t){define=function define(t,r,o){return t[r]=o}}function wrap(t,r,o,a){var l=r&&r.prototype instanceof Generator?r:Generator,c=Object.create(l.prototype),u=new Context(a||[]);return i(c,"_invoke",{value:makeInvokeMethod(t,o,u)}),c}function tryCatch(t,r,o){try{return{type:"normal",arg:t.call(r,o)}}catch(t){return{type:"throw",arg:t}}}t.wrap=wrap;var p={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var d={};define(d,l,(function(){return this}));var h=Object.getPrototypeOf,y=h&&h(h(values([])));y&&y!==r&&o.call(y,l)&&(d=y);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(d);function defineIteratorMethods(t){["next","throw","return"].forEach((function(r){define(t,r,(function(t){return this._invoke(r,t)}))}))}function AsyncIterator(t,r){function invoke(i,a,l,c){var u=tryCatch(t[i],t,a);if("throw"!==u.type){var p=u.arg,d=p.value;return d&&"object"==settings_typeof(d)&&o.call(d,"__await")?r.resolve(d.__await).then((function(t){invoke("next",t,l,c)}),(function(t){invoke("throw",t,l,c)})):r.resolve(d).then((function(t){p.value=t,l(p)}),(function(t){return invoke("throw",t,l,c)}))}c(u.arg)}var a;i(this,"_invoke",{value:function value(t,o){function callInvokeWithMethodAndArg(){return new r((function(r,i){invoke(t,o,r,i)}))}return a=a?a.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,r,o){var i="suspendedStart";return function(a,l){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===a)throw l;return doneResult()}for(o.method=a,o.arg=l;;){var c=o.delegate;if(c){var u=maybeInvokeDelegate(c,o);if(u){if(u===p)continue;return u}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===i)throw i="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);i="executing";var d=tryCatch(t,r,o);if("normal"===d.type){if(i=o.done?"completed":"suspendedYield",d.arg===p)continue;return{value:d.arg,done:o.done}}"throw"===d.type&&(i="completed",o.method="throw",o.arg=d.arg)}}}function maybeInvokeDelegate(t,r){var o=r.method,i=t.iterator[o];if(void 0===i)return r.delegate=null,"throw"===o&&t.iterator.return&&(r.method="return",r.arg=void 0,maybeInvokeDelegate(t,r),"throw"===r.method)||"return"!==o&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+o+"' method")),p;var a=tryCatch(i,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,p;var l=a.arg;return l?l.done?(r[t.resultName]=l.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,p):l:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function pushTryEntry(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function resetTryEntry(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var r=t[l];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function next(){for(;++i<t.length;)if(o.call(t,i))return next.value=t[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return a.next=a}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,i(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),i(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===GeneratorFunction||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(r,o,i,a,l){void 0===l&&(l=Promise);var c=new AsyncIterator(wrap(r,o,i,a),l);return t.isGeneratorFunction(o)?c:c.next().then((function(t){return t.done?t.value:c.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,l,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var r=Object(t),o=[];for(var i in r)o.push(i);return o.reverse(),function next(){for(;o.length;){var t=o.pop();if(t in r)return next.value=t,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function reset(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=void 0)},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function dispatchException(t){if(this.done)throw t;var r=this;function handle(o,i){return l.type="throw",l.arg=t,r.next=o,i&&(r.method="next",r.arg=void 0),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],l=a.completion;if("root"===a.tryLoc)return handle("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0);if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return handle(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return handle(a.finallyLoc)}}}},abrupt:function abrupt(t,r){for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i];if(a.tryLoc<=this.prev&&o.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var l=a;break}}l&&("break"===t||"continue"===t)&&l.tryLoc<=r&&r<=l.finallyLoc&&(l=null);var c=l?l.completion:{};return c.type=t,c.arg=r,l?(this.method="next",this.next=l.finallyLoc,p):this.complete(c)},complete:function complete(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),p},finish:function finish(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.finallyLoc===t)return this.complete(o.completion,o.afterLoc),resetTryEntry(o),p}},catch:function _catch(t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc===t){var i=o.completion;if("throw"===i.type){var a=i.arg;resetTryEntry(o)}return a}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(t,r,o){return this.delegate={iterator:values(t),resultName:r,nextLoc:o},"next"===this.method&&(this.arg=void 0),p}},t}function settings_slicedToArray(t,r){return function settings_arrayWithHoles(t){if(Array.isArray(t))return t}(t)||function settings_iterableToArrayLimit(t,r){var o=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=o){var i,a,l,c,u=[],p=!0,d=!1;try{if(l=(o=o.call(t)).next,0===r){if(Object(o)!==o)return;p=!1}else for(;!(p=(i=l.call(o)).done)&&(u.push(i.value),u.length!==r);p=!0);}catch(t){d=!0,a=t}finally{try{if(!p&&null!=o.return&&(c=o.return(),Object(c)!==c))return}finally{if(d)throw a}}return u}}(t,r)||function settings_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return settings_arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);if("Map"===o||"Set"===o)return Array.from(t);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return settings_arrayLikeToArray(t,r)}(t,r)||function settings_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function settings_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function settings_asyncGeneratorStep(t,r,o,i,a,l,c){try{var u=t[l](c),p=u.value}catch(t){return void o(t)}u.done?r(p):Promise.resolve(p).then(i,a)}function registerSettings(){!function registerSettingsArray(t){for(var r=0,o=Object.entries(t);r<o.length;r++){var i=settings_slicedToArray(o[r],2),a=i[0],l=i[1];game.settings.register(I,a,l)}}({globalConfig:{type:Object,config:!1,default:E,scope:"world"},hideActorHeaderText:{name:game.i18n.localize("".concat(I,".settings.hideActorHeaderText.name")),hint:game.i18n.localize("".concat(I,".settings.hideActorHeaderText.hint")),scope:"world",config:!0,default:!1,type:Boolean},paperDollPosition:{name:game.i18n.localize("".concat(I,".settings.paperDollPosition.name")),hint:game.i18n.localize("".concat(I,".settings.paperDollPosition.hint")),scope:"world",config:!0,default:"left",type:String,choices:{left:game.i18n.localize("".concat(I,".settings.paperDollPosition.choices.left")),right:game.i18n.localize("".concat(I,".settings.paperDollPosition.choices.right")),center:game.i18n.localize("".concat(I,".settings.paperDollPosition.choices.center"))}},autoOpen:{name:game.i18n.localize("".concat(I,".settings.autoOpen.name")),hint:game.i18n.localize("".concat(I,".settings.autoOpen.hint")),scope:"client",config:!0,default:!1,type:Boolean},allowNonOwned:{name:game.i18n.localize("".concat(I,".settings.allowNonOwned.name")),hint:game.i18n.localize("".concat(I,".settings.allowNonOwned.hint")),scope:"world",config:!0,default:!1,type:Boolean},playerOwnedOnly:{name:game.i18n.localize("".concat(I,".settings.playerOwnedOnly.name")),hint:game.i18n.localize("".concat(I,".settings.playerOwnedOnly.hint")),scope:"world",config:!0,default:!1,type:Boolean}}),game.settings.registerMenu(I,"globalConfigMenu",{name:game.i18n.localize("".concat(I,".settings.globalConfigMenu.name")),label:game.i18n.localize("".concat(I,".settings.globalConfigMenu.label")),hint:game.i18n.localize("".concat(I,".settings.globalConfigMenu.hint")),icon:"fas fa-cogs",type:C,restricted:!0})}function getSetting(t){return"globalConfig"==t?foundry.utils.deepClone(foundry.utils.mergeObject(E,game.settings.get(I,t))):game.settings.get(I,t)}function setSetting(t,r){return _setSetting.apply(this,arguments)}function _setSetting(){return _setSetting=function settings_asyncToGenerator(t){return function(){var r=this,o=arguments;return new Promise((function(i,a){var l=t.apply(r,o);function _next(t){settings_asyncGeneratorStep(l,i,a,_next,_throw,"next",t)}function _throw(t){settings_asyncGeneratorStep(l,i,a,_next,_throw,"throw",t)}_next(void 0)}))}}(settings_regeneratorRuntime().mark((function _callee(t,r){return settings_regeneratorRuntime().wrap((function _callee$(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,game.settings.set(I,t,r);case 2:return o.abrupt("return",o.sent);case 3:case"end":return o.stop()}}),_callee)}))),_setSetting.apply(this,arguments)}var I="fvtt-paper-doll-ui",E={EQUIPPED_PATH:"",HUE_ROTATE:0,MAIN_COLOR:"#191005",SLOTS:{LEFT:{HEAD:[{img:"icons/equipment/head/helm-barbute-engraved-steel.webp"}],CAPE:[{img:"icons/equipment/back/cape-layered-red.webp"}],BODY:[{img:"icons/equipment/chest/breastplate-layered-steel.webp"}],GLOVES:[{img:"icons/equipment/hand/glove-frayed-cloth-grey.webp"}],BOOTS:[{img:"icons/equipment/feet/boots-armored-layered-steel.webp"}]},RIGHT:{TRINKET:[{img:"icons/tools/laboratory/alembic-glass-ball-blue.webp"},{img:"icons/tools/laboratory/alembic-glass-ball-blue.webp"},{img:"icons/tools/laboratory/alembic-glass-ball-blue.webp"}],PENDANT:[{img:"icons/equipment/neck/pendant-rough-red.webp"}],RING:[{img:"icons/equipment/finger/ring-band-gold.webp"},{img:"icons/equipment/finger/ring-band-gold.webp"}]},BOTTOM_LEFT_WRIST:{WRIST_LEFT:[{img:"icons/sundries/lights/torch-black.webp"}]},BOTTOM_LEFT_MAIN:{MAIN_LEFT:[{img:"icons/weapons/swords/shortsword-winged.webp"},{img:"icons/weapons/swords/shortsword-winged.webp"}]},BOTTOM_RIGHT_WRIST:{WRIST_RIGHT:[{img:"icons/weapons/thrown/bomb-fuse-cloth-pink.webp"}]},BOTTOM_RIGHT_MAIN:{MAIN_RIGHT:[{img:"icons/weapons/bows/shortbow-recurve-bone.webp"},{img:"icons/weapons/bows/shortbow-recurve-bone.webp"}]}}},G=foundry.utils.deepClone(E);Hooks.on("init",(function(){E.EQUIPPED_PATH=function getEquippedPath(){return"dnd5e"===game.system.id?"equipped":""}(),function registerHotkeys(){game.keybindings.register(I,"togglePaperDoll",{name:"".concat(I,".hotkeys.togglePaperDoll.name"),editable:[{key:"KeyP",modifiers:[KeyboardManager.MODIFIER_KEYS.SHIFT]}],restricted:!1,precedence:CONST.KEYBINDING_PRECEDENCE.PRIORITY,onDown:function onDown(){ui.paperDoll.toggle()}})}(),registerSettings(),ui.paperDoll=T})),Hooks.on("getActorSheetHeaderButtons",(function(t,r){var o,i=getSetting("playerOwnedOnly"),a=null!==(o=t.object)&&void 0!==o?o:t.actor;if(!i||a.hasPlayerOwner){r.unshift({class:"paper-doll",icon:"fa-duotone fa-person",onclick:function onclick(){var r,o,i=null!==(r=t.object)&&void 0!==r?r:t.actor,a=Object.values(ui.windows).find((function(t){return t instanceof T&&t.actor===i}));a?a.close():new T(null!==(o=t.object)&&void 0!==o?o:t.actor).render(!0)},label:getSetting("hideActorHeaderText")?"":game.i18n.localize("".concat(I,".app.paper-doll.title"))});var l=getSetting("autoOpen"),c=t.actor.getFlag(I,"autoOpen")||"useDefault";("useDefault"===c&&l||"true"===c)&&setTimeout((function(){var r;new T(null!==(r=t.object)&&void 0!==r?r:t.actor).render(!0)}),10)}}))})();
//# sourceMappingURL=index.js.map